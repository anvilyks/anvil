waitForEditorAndRun(async () => {
    const project = await window.load_files_callback();
    const assets = editor.AssetManager.getAll().models;

    const customToBlobMap = {};
    for (const a of assets) {
      const src = a.get('src');
      const name = a.get('name');

      if (src && name && src.startsWith('blob:')) {
        const custom = `custom:anvil-assets/${name}`;
        customToBlobMap[custom] = src;
      }
    }

    replaceCustomToBlobInAssets(project, customToBlobMap);
    replaceCustomToBlobInPages(project, customToBlobMap);
  });
